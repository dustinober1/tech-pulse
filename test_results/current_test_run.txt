============================= test session starts ==============================
collecting ... collected 120 items

test/test_cache_manager.py::TestCacheManager::test_cache_expiry PASSED   [  0%]
test/test_cache_manager.py::TestCacheManager::test_cache_miss_conditions PASSED [  1%]
test/test_cache_manager.py::TestCacheManager::test_cache_with_different_analysis_types PASSED [  2%]
test/test_cache_manager.py::TestCacheManager::test_clear_cache PASSED    [  3%]
test/test_cache_manager.py::TestCacheManager::test_empty_dataframe_handling PASSED [  4%]
test/test_cache_manager.py::TestCacheManager::test_error_handling PASSED [  5%]
test/test_cache_manager.py::TestCacheManager::test_generate_cache_key PASSED [  5%]
test/test_cache_manager.py::TestCacheManager::test_get_cache_info PASSED [  6%]
test/test_cache_manager.py::TestCacheManager::test_initialization PASSED [  7%]
test/test_cache_manager.py::TestCacheManager::test_logging PASSED        [  8%]
test/test_cache_manager.py::TestCacheManager::test_save_and_load_cache PASSED [  9%]
test/test_dashboard.py::TestDashboardConfig::test_color_scheme PASSED    [ 10%]
test/test_dashboard.py::TestDashboardConfig::test_default_settings PASSED [ 10%]
test/test_dashboard.py::TestDashboardConfig::test_page_config_structure PASSED [ 11%]
test/test_dashboard.py::TestDashboardInitialization::test_initialize_session_state FAILED [ 12%]
test/test_dashboard.py::TestDashboardInitialization::test_initialize_session_state_preserves_existing FAILED [ 13%]
test/test_dashboard.py::TestDashboardComponents::test_create_charts_row_with_data PASSED [ 14%]
test/test_dashboard.py::TestDashboardComponents::test_create_data_table_with_data PASSED [ 15%]
test/test_dashboard.py::TestDashboardComponents::test_create_header PASSED [ 15%]
test/test_dashboard.py::TestDashboardComponents::test_create_metrics_row_with_data PASSED [ 16%]
test/test_dashboard.py::TestDashboardComponents::test_create_metrics_row_with_empty_data PASSED [ 17%]
test/test_dashboard.py::TestDashboardComponents::test_create_sidebar FAILED [ 18%]
test/test_dashboard.py::TestDashboardDataOperations::test_check_auto_refresh_disabled FAILED [ 19%]
test/test_dashboard.py::TestDashboardDataOperations::test_check_auto_refresh_enabled_not_triggered FAILED [ 20%]
test/test_dashboard.py::TestDashboardDataOperations::test_check_auto_refresh_enabled_triggered FAILED [ 20%]
test/test_dashboard.py::TestDashboardDataOperations::test_export_data_csv PASSED [ 21%]
test/test_dashboard.py::TestDashboardDataOperations::test_export_data_json PASSED [ 22%]
test/test_dashboard.py::TestDashboardDataOperations::test_export_data_no_data PASSED [ 23%]
test/test_dashboard.py::TestDashboardDataOperations::test_refresh_data_api_error PASSED [ 24%]
test/test_dashboard.py::TestDashboardDataOperations::test_refresh_data_empty_response PASSED [ 25%]
test/test_dashboard.py::TestDashboardDataOperations::test_refresh_data_success PASSED [ 25%]
test/test_dashboard.py::TestDashboardMain::test_main_with_data PASSED    [ 26%]
test/test_dashboard.py::TestDashboardMain::test_main_without_data PASSED [ 27%]
test/test_dashboard.py::TestDashboardIntegration::test_data_flow_integration FAILED [ 28%]
test/test_dashboard_basic.py::TestDashboardBasicFunctionality::test_basic_data_structure_compatibility PASSED [ 29%]
test/test_dashboard_basic.py::TestDashboardBasicFunctionality::test_dashboard_config_import PASSED [ 30%]
test/test_dashboard_basic.py::TestDashboardBasicFunctionality::test_data_loader_integration PASSED [ 30%]
test/test_dashboard_basic.py::TestDashboardBasicFunctionality::test_export_format_options PASSED [ 31%]
test/test_dashboard_basic.py::TestDashboardBasicFunctionality::test_required_dependencies_available PASSED [ 32%]
test/test_dashboard_basic.py::TestDashboardBasicFunctionality::test_sentiment_label_values PASSED [ 33%]
test/test_dashboard_config.py::TestDashboardConfig::test_chart_config PASSED [ 34%]
test/test_dashboard_config.py::TestDashboardConfig::test_color_scheme PASSED [ 35%]
test/test_dashboard_config.py::TestDashboardConfig::test_config_consistency PASSED [ 35%]
test/test_dashboard_config.py::TestDashboardConfig::test_default_settings PASSED [ 36%]
test/test_dashboard_config.py::TestDashboardConfig::test_error_messages PASSED [ 37%]
test/test_dashboard_config.py::TestDashboardConfig::test_help_text PASSED [ 38%]
test/test_dashboard_config.py::TestDashboardConfig::test_loading_messages PASSED [ 39%]
test/test_dashboard_config.py::TestDashboardConfig::test_page_config_structure PASSED [ 40%]
test/test_dashboard_config.py::TestDashboardConfig::test_page_config_values PASSED [ 40%]
test/test_dashboard_config.py::TestDashboardConfig::test_sentiment_colors PASSED [ 41%]
test/test_dashboard_config.py::TestDashboardConfig::test_success_messages PASSED [ 42%]
test/test_data_loader.py::TestFetchStoryIds::test_fetch_story_ids_connection_error PASSED [ 43%]
test/test_data_loader.py::TestFetchStoryIds::test_fetch_story_ids_custom_url PASSED [ 44%]
test/test_data_loader.py::TestFetchStoryIds::test_fetch_story_ids_json_error PASSED [ 45%]
test/test_data_loader.py::TestFetchStoryIds::test_fetch_story_ids_success PASSED [ 45%]
test/test_data_loader.py::TestFetchStoryDetails::test_fetch_story_details_custom_url PASSED [ 46%]
test/test_data_loader.py::TestFetchStoryDetails::test_fetch_story_details_not_found PASSED [ 47%]
test/test_data_loader.py::TestFetchStoryDetails::test_fetch_story_details_success PASSED [ 48%]
test/test_data_loader.py::TestExtractStoryData::test_extract_story_data_complete PASSED [ 49%]
test/test_data_loader.py::TestExtractStoryData::test_extract_story_data_empty_dict PASSED [ 50%]
test/test_data_loader.py::TestExtractStoryData::test_extract_story_data_minimal PASSED [ 50%]
test/test_data_loader.py::TestExtractStoryData::test_extract_story_data_missing_optional_fields PASSED [ 51%]
test/test_data_loader.py::TestExtractStoryData::test_extract_story_data_no_title PASSED [ 52%]
test/test_data_loader.py::TestExtractStoryData::test_extract_story_data_none_input PASSED [ 53%]
test/test_data_loader.py::TestProcessStoriesToDataframe::test_process_stories_to_dataframe_empty PASSED [ 54%]
test/test_data_loader.py::TestProcessStoriesToDataframe::test_process_stories_to_dataframe_none PASSED [ 55%]
test/test_data_loader.py::TestProcessStoriesToDataframe::test_process_stories_to_dataframe_single_story PASSED [ 55%]
test/test_data_loader.py::TestProcessStoriesToDataframe::test_process_stories_to_dataframe_success PASSED [ 56%]
test/test_data_loader.py::TestFetchHnData::test_fetch_hn_data_custom_limit FAILED [ 57%]
test/test_data_loader.py::TestFetchHnData::test_fetch_hn_data_ids_fetch_fails PASSED [ 58%]
test/test_data_loader.py::TestFetchHnData::test_fetch_hn_data_skip_invalid_stories PASSED [ 59%]
test/test_data_loader.py::TestFetchHnData::test_fetch_hn_data_story_details_fails PASSED [ 60%]
test/test_data_loader.py::TestFetchHnData::test_fetch_hn_data_success FAILED [ 60%]
test/test_data_loader.py::TestAnalyzeSentiment::test_analyze_sentiment_empty_dataframe PASSED [ 61%]
test/test_data_loader.py::TestAnalyzeSentiment::test_analyze_sentiment_missing_title_column PASSED [ 62%]
test/test_data_loader.py::TestAnalyzeSentiment::test_analyze_sentiment_normal_case PASSED [ 63%]
test/test_data_loader.py::TestAnalyzeSentiment::test_analyze_sentiment_with_empty_titles PASSED [ 64%]
test/test_data_loader.py::TestGetTopics::test_get_topics_custom_embedding_model PASSED [ 65%]
test/test_data_loader.py::TestGetTopics::test_get_topics_empty_dataframe PASSED [ 65%]
test/test_data_loader.py::TestGetTopics::test_get_topics_insufficient_data PASSED [ 66%]
test/test_data_loader.py::TestGetTopics::test_get_topics_missing_title_column PASSED [ 67%]
test/test_data_loader.py::TestGetTopics::test_get_topics_model_error PASSED [ 68%]
test/test_data_loader.py::TestGetTopics::test_get_topics_normal_case PASSED [ 69%]
test/test_data_loader.py::TestGetTopics::test_get_topics_with_none_titles PASSED [ 70%]
test/test_deployment_ready.py::TestDeploymentReady::test_app_py_exists PASSED [ 70%]
test/test_deployment_ready.py::TestDeploymentReady::test_app_py_has_main PASSED [ 71%]
test/test_deployment_ready.py::TestDeploymentReady::test_cache_manager_exists PASSED [ 72%]
test/test_deployment_ready.py::TestDeploymentReady::test_dashboard_config_exists PASSED [ 73%]
test/test_deployment_ready.py::TestDeploymentReady::test_data_loader_exists PASSED [ 74%]
test/test_deployment_ready.py::TestDeploymentReady::test_git_clean PASSED [ 75%]
test/test_deployment_ready.py::TestDeploymentReady::test_gitignore_ready PASSED [ 75%]
test/test_deployment_ready.py::TestDeploymentReady::test_no_absolute_local_paths PASSED [ 76%]
test/test_deployment_ready.py::TestDeploymentReady::test_remote_exists PASSED [ 77%]
test/test_deployment_ready.py::TestDeploymentReady::test_requirements_complete PASSED [ 78%]
test/test_deployment_ready.py::TestDeploymentReady::test_streamlit_page_config PASSED [ 79%]
test/test_gitignore.py::TestGitignore::test_cache_directory_excluded PASSED [ 80%]
test/test_gitignore.py::TestGitignore::test_ds_store_excluded PASSED     [ 80%]
test/test_gitignore.py::TestGitignore::test_env_file_excluded PASSED     [ 81%]
test/test_gitignore.py::TestGitignore::test_gitignore_exists PASSED      [ 82%]
test/test_gitignore.py::TestGitignore::test_pycache_excluded PASSED      [ 83%]
test/test_gitignore.py::TestGitignore::test_venv_excluded PASSED         [ 84%]
test/test_requirements.py::TestRequirements::test_no_standard_library_packages PASSED [ 85%]
test/test_requirements.py::TestRequirements::test_required_packages_present PASSED [ 85%]
test/test_requirements.py::TestRequirements::test_requirements_file_exists PASSED [ 86%]
test/test_requirements.py::TestRequirements::test_requirements_file_format PASSED [ 87%]
test/test_requirements.py::TestRequirements::test_version_specifications PASSED [ 88%]
test/test_streamlit_config.py::TestStreamlitConfig::test_config_toml_exists PASSED [ 89%]
test/test_streamlit_config.py::TestStreamlitConfig::test_config_toml_valid_syntax PASSED [ 90%]
test/test_streamlit_config.py::TestStreamlitConfig::test_secrets_example_exists PASSED [ 90%]
test/test_streamlit_config.py::TestStreamlitConfig::test_secrets_toml_in_gitignore PASSED [ 91%]
test/test_streamlit_config.py::TestStreamlitConfig::test_streamlit_directory_exists PASSED [ 92%]
test/test_verify_deployment.py::TestVerifyDeployment::test_verify_deployment_404_error PASSED [ 93%]
test/test_verify_deployment.py::TestVerifyDeployment::test_verify_deployment_500_error PASSED [ 94%]
test/test_verify_deployment.py::TestVerifyDeployment::test_verify_deployment_connection_error PASSED [ 95%]
test/test_verify_deployment.py::TestVerifyDeployment::test_verify_deployment_empty_url PASSED [ 95%]
test/test_verify_deployment.py::TestVerifyDeployment::test_verify_deployment_generic_request_exception PASSED [ 96%]
test/test_verify_deployment.py::TestVerifyDeployment::test_verify_deployment_invalid_url PASSED [ 97%]
test/test_verify_deployment.py::TestVerifyDeployment::test_verify_deployment_redirect_success PASSED [ 98%]
test/test_verify_deployment.py::TestVerifyDeployment::test_verify_deployment_success PASSED [ 99%]
test/test_verify_deployment.py::TestVerifyDeployment::test_verify_deployment_timeout PASSED [100%]

=================================== FAILURES ===================================
__________ TestDashboardInitialization.test_initialize_session_state ___________
test/test_dashboard.py:86: in test_initialize_session_state
    app.initialize_session_state()
app.py:27: in initialize_session_state
    st.session_state.data = None
    ^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'dict' object has no attribute 'data' and no __dict__ for setting new attributes
_ TestDashboardInitialization.test_initialize_session_state_preserves_existing _
test/test_dashboard.py:100: in test_initialize_session_state_preserves_existing
    app.initialize_session_state()
app.py:29: in initialize_session_state
    st.session_state.last_refresh = None
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'dict' object has no attribute 'last_refresh' and no __dict__ for setting new attributes
_________________ TestDashboardComponents.test_create_sidebar __________________
test/test_dashboard.py:138: in test_create_sidebar
    mock_st.sidebar.slider.assert_called()
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:948: in assert_called
    raise AssertionError(msg)
E   AssertionError: Expected 'slider' to have been called.
----------------------------- Captured stdout call -----------------------------
No valid cache found, fetching fresh data...
Fetching top story IDs...
Fetching details for 1 stories...
Fetching story 1/1 (ID: 46155135)
Successfully fetched 1 stories.
Data saved to cache
Analyzing sentiment using VADER...
Sentiment Analysis Results:
  Neutral: 1 stories (100.0%)
Extracting topics using BERTopic...
Warning: Need at least 2 valid titles for topic modeling
------------------------------ Captured log call -------------------------------
ERROR    cache_manager:cache_manager.py:160 Error saving to cache: Object of type MagicMock is not JSON serializable
_________ TestDashboardDataOperations.test_check_auto_refresh_disabled _________
test/test_dashboard.py:310: in test_check_auto_refresh_disabled
    app.st.session_state.auto_refresh = False
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'dict' object has no attribute 'auto_refresh' and no __dict__ for setting new attributes
__ TestDashboardDataOperations.test_check_auto_refresh_enabled_not_triggered ___
test/test_dashboard.py:319: in test_check_auto_refresh_enabled_not_triggered
    app.st.session_state.auto_refresh = True
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'dict' object has no attribute 'auto_refresh' and no __dict__ for setting new attributes
____ TestDashboardDataOperations.test_check_auto_refresh_enabled_triggered _____
test/test_dashboard.py:329: in test_check_auto_refresh_enabled_triggered
    app.st.session_state.auto_refresh = True
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E   AttributeError: 'dict' object has no attribute 'auto_refresh' and no __dict__ for setting new attributes
_____________ TestDashboardIntegration.test_data_flow_integration ______________
test/test_dashboard.py:419: in test_data_flow_integration
    mock_fetch.assert_called_once()
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:958: in assert_called_once
    raise AssertionError(msg)
E   AssertionError: Expected 'fetch_hn_data' to have been called once. Called 0 times.
_______________ TestFetchHnData.test_fetch_hn_data_custom_limit ________________
test/test_data_loader.py:377: in test_fetch_hn_data_custom_limit
    self.assertEqual(mock_details.call_count, 10)
E   AssertionError: 0 != 10
__________________ TestFetchHnData.test_fetch_hn_data_success __________________
test/test_data_loader.py:298: in test_fetch_hn_data_success
    mock_fetch_ids.assert_called_once()
/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/unittest/mock.py:958: in assert_called_once
    raise AssertionError(msg)
E   AssertionError: Expected 'fetch_story_ids' to have been called once. Called 0 times.
=========================== short test summary info ============================
FAILED test/test_dashboard.py::TestDashboardInitialization::test_initialize_session_state
FAILED test/test_dashboard.py::TestDashboardInitialization::test_initialize_session_state_preserves_existing
FAILED test/test_dashboard.py::TestDashboardComponents::test_create_sidebar
FAILED test/test_dashboard.py::TestDashboardDataOperations::test_check_auto_refresh_disabled
FAILED test/test_dashboard.py::TestDashboardDataOperations::test_check_auto_refresh_enabled_not_triggered
FAILED test/test_dashboard.py::TestDashboardDataOperations::test_check_auto_refresh_enabled_triggered
FAILED test/test_dashboard.py::TestDashboardIntegration::test_data_flow_integration
FAILED test/test_data_loader.py::TestFetchHnData::test_fetch_hn_data_custom_limit
FAILED test/test_data_loader.py::TestFetchHnData::test_fetch_hn_data_success
======================== 9 failed, 111 passed in 7.29s =========================
